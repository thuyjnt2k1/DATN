import numpy as np
from scipy.cluster.hierarchy import linkage, fcluster
import pandas as pd
from namematcher import NameMatcher
import time
from collections import defaultdict
from scipy.spatial.distance import pdist
from opencage.geocoder import OpenCageGeocode
import numpy as np
from sklearn.cluster import AgglomerativeClustering
import re
from multiprocessing import Process, Manager
import multiprocessing
from scipy.spatial.distance import cdist
import json
import csv
import networkx as nx
import matplotlib.pyplot as plt
import pandas as pd

name_matcher = NameMatcher()

def get_neighbor(node_id):
    neighbor_rows = df_links[(df_links['from'] == node_id) | (df_links['to'] == node_id)]
    neighbor_nodes = pd.unique(neighbor_rows[['from', 'to']].values.ravel())
    neighbor_nodes = [node for node in neighbor_nodes if node != node_id]
    return neighbor_nodes

def caculate_neighbor_sim(id1, id2):
    neighbor_1 = get_neighbor(id1)
    neighbor_2 = get_neighbor(id2)
    if len(neighbor_1) == 0 or len(neighbor_2) == 0:
        return 0
    intersection = len(set(neighbor_1).intersection(set(neighbor_2)))
    result = intersection / len(neighbor_1) if intersection / len(neighbor_1) > intersection / len(neighbor_2) else intersection / len(neighbor_2)
    return result

def simple_string(string):
    return re.sub(r"[!\"#$%&()*+,\-/:;<=>?@\[\\\]^_`{|}~]", " ", string)

def caculate_ahc_distance(id1, id2):
    node1 = df_author.loc[id1]
    node2 = df_author.loc[id2]
    if(node1['link'].split('//')[1].split('/')[0] == node2['link'].split('//')[1].split('/')[0]):
        return 1
    name_sim = name_matcher.match_names(simple_string(node1['name']), simple_string(node2['name']))
    # print(node1['name'], node2['name'], name_sim)
    neighbor_sim = caculate_neighbor_sim(id1, id2)
    if(1 - 0.85 * name_sim - 0.15 * neighbor_sim < 0.1):
        print('\n*************', id1, id2, node1['name'], node2['name'], name_sim, neighbor_sim)
    return 1 - 0.85 * name_sim - 0.15 * neighbor_sim

def get_process_neighbor(node_id, df_links):
    neighbor_rows = df_links[(df_links['from'] == node_id) | (df_links['to'] == node_id)]
    neighbor_nodes = pd.unique(neighbor_rows[['from', 'to']].values.ravel())
    neighbor_nodes = [node for node in neighbor_nodes if node != node_id]
    return neighbor_nodes

def caculate_process_neighbor_sim(id1, id2, df_links):
    neighbor_1 = get_process_neighbor(id1, df_links)
    neighbor_2 = get_process_neighbor(id2, df_links)
    if len(neighbor_1) == 0 or len(neighbor_2) == 0:
        return 0
    intersection = len(set(neighbor_1).intersection(set(neighbor_2)))
    result = intersection / len(neighbor_1) if intersection / len(neighbor_1) > intersection / len(neighbor_2) else intersection / len(neighbor_2)
    return result

def caculate_process_ahc_distance(id1, id2, df_author, df_links):
    node1 = df_author.loc[id1]
    node2 = df_author.loc[id2]
    if(node1['link'].split('//')[1].split('/')[0] == node2['link'].split('//')[1].split('/')[0]):
        return 1
    name_sim = name_matcher.match_names(simple_string(node1['name']), simple_string(node2['name']))
    # print(node1['name'], node2['name'], name_sim)
    neighbor_sim = caculate_process_neighbor_sim(id1, id2, df_links)
    if(1 - 0.85 * name_sim - 0.15 * neighbor_sim < 0.1):
        print('\n*************', id1, id2, node1['name'], node2['name'], name_sim, neighbor_sim)
    return 1 - 0.85 * name_sim - 0.15 * neighbor_sim

def process_author_ahc_distance(L, id_from, id_to, matched_graph_node, df_author, df_links):
    print(id_from, id_to, df_author, df_links)
    for i, id1 in enumerate(matched_graph_node):
        if(i < id_from or i > id_to):
            continue
        for j, id2 in enumerate(matched_graph_node):
            if(i > j):
                continue;
            if(i == j):
                # L[i][i] = 0
                L[i*len(matched_graph_node) + i] = 0
                continue;
            distance = caculate_process_ahc_distance(id1, id2,df_author, df_links)
            # distance = 0.5
            # print(id1, id2, distance)
            # L[i][j] = distance
            # L[j][i] = distance
            L[i*len(matched_graph_node) + j] = distance
            L[j*len(matched_graph_node) + i] = distance
        # print('\nDone ', id1)

def multiprocessing_ahc_distance():
    global matched_graph_node
    with Manager() as manager:  
        df_author_global = df_author
        df_link_global = df_links
        n = len(matched_graph_node)
        # L = manager.list()
        processes = []
        # L =  np.zeros((n, n))
        L = manager.list([0] * (n * n))
        for i in range(5):
            start =  i * n//5
            end =  (i+1) * n//5 - 1
            p = Process(target=process_author_ahc_distance, args=(L,start, end, matched_graph_node, df_author, df_links, ))
            p.start()
            processes.append(p)
        for p in processes:
            p.join()

        L_final = np.array(L).reshape(n, n)
        return L_final  

def author_ahc_distance():
    global matched_graph_node
    # distance_matrix = [[caculate_ahc_distance(point1, point2) for point2 in df_author.index] for point1 in df_author.index]
    # distance_matrix = pd.DataFrame(index=df_author.index, columns=df_author.index)
    # distance_matrix = distance_matrix.astype('float64')
    # distance_matrix = cdist(df_author.index, df_author.index, metric=caculate_ahc_distance)
    n = len(matched_graph_node)
    distance_matrix = np.zeros((n, n))
    for i, id1 in enumerate(matched_graph_node):
        for j, id2 in enumerate(matched_graph_node):
            if(i > j):
                continue;
            if(i == j):
                distance_matrix[i, i] = 1
                continue;
            # print(id1, id2)
            distance = caculate_ahc_distance(id1, id2)
            # print(id1, id2, distance)
            distance_matrix[i, j] = distance
            distance_matrix[j, i] = distance
    # distance_matrix = pdist(df_author.values, metric=caculate_ahc_distance_pdist)
    # print(distance_matrix)
        # print('\nDone ', id1)
    return distance_matrix
    # print(distances)
    # return distances

# def author_ahc_distance():
#     n = len(df_author.index)
#     distance_matrix = np.zeros((n, n))

#     with mp.Pool(processes=mp.cpu_count()) as pool:
#         results = [pool.apply_async(caculate_ahc_distance, args=(id1, id2))
#                    for id1 in df_author.index for id2 in df_author.index]
#         for i, (id1, id2) in enumerate([(id1, id2) for id1 in df_author.index for id2 in df_author.index]):
#             distance = results[i].get()
#             distance_matrix[df_author.index.get_loc(id1), df_author.index.get_loc(id2)] = distance
#             distance_matrix[df_author.index.get_loc(id2), df_author.index.get_loc(id1)] = distance

#     return distance_matrix

def match_author_from_paper(paper_id):
    neighbors = get_neighbor(paper_id)
    neighbors_name = df_author.iloc[df_author.index.isin(neighbors), df_author.columns.get_loc('name')]
    print(neighbors, neighbors_name)
    matched_list = []
    for id1, name1 in neighbors_name.items():
        if id1 in matched_list:
            continue; 
        for id2, name2 in neighbors_name.items():
            if id2 in matched_list or id1 >= id2:
                continue;
            if name_matcher.match_names(simple_string(name1), simple_string(name2)) > 0.9:
                matched_list.append(id1)
                matched_list.append(id2)
                match_author(id1, id2);
                continue;

def match_paper(id1, id2):
    global df_nodes, df_paper, df_links, df_matching
    print('\nmatch paper', id1, id2)
    df_matching._append({'id1': id1, 'id2': id2, 'type': 'paper'}, ignore_index = True)
    node1 = df_nodes.loc[id1]
    node2 = df_nodes.loc[id2]
    df_nodes.loc[id1, 'link'] = node1['link'] + '; ' + node2['link']
    df_nodes = df_nodes.drop(id2)

    paper1 = df_paper.loc[id1]
    paper2 = df_paper.loc[id2]
    df_paper.loc[id1, 'link'] = paper1['link'] + '; ' + paper2['link']
    df_paper = df_paper.drop(id2)
    df_links.loc[df_links['from'] == id2, 'from'] = id1
    df_links.loc[df_links['to'] == id2, 'to'] = id1

    match_author_from_paper(id1)

def match_author(id1, id2):
    global df_nodes, df_author, df_links, df_matching
    print('\nmatch author', id1, id2, '\n')
    df_matching._append({'id1': id1, 'id2': id2, 'type':'author'}, ignore_index = True)
    node1 = df_nodes.loc[id1]
    node2 = df_nodes.loc[id2]
    df_nodes.loc[id1, 'link'] = node1['link'] + '; ' + node2['link']
    df_nodes = df_nodes.drop(id2)

    author1 = df_author.loc[id1]
    author2 = df_author.loc[id2]
    if(author2['orcid']):
        df_author.loc[id1, 'orcid'] = author2['orcid']
    if(author2['email']):
        df_author.loc[id1, 'email'] = author2['email']
    affiliations = set(str(author1['affiliation']).split(';')) | set(str(author2['affiliation']).split(';'))
    df_author.loc[id1, 'affiliation'] = '; '.join(affiliations)
    df_author.loc[id1, 'link'] = author1['link'] + '; ' + author2['link']
    df_author = df_author.drop(id2)
    df_links.loc[df_links['from'] == id2, 'from'] = id1
    df_links.loc[df_links['to'] == id2, 'to'] = id1

def paper_match_process():
    paper_block = defaultdict()
    for id, doi in zip(df_paper.index, df_paper['doi']):
        if(doi in paper_block):
            match_paper(paper_block[doi], id)
        else:
            paper_block[doi] = id

def get_author_block(id, name, author_block):
    for index, authors in author_block.items():
        for author_name in authors.values():
            if(name_matcher.match_names(simple_string(name), simple_string(author_name)) > 0.9):
                return index
    return -1

def author_match_blocking(author_block):
    for id, name in zip(df_author.index, df_author['name']):
        parsed_name = name_matcher.parse_name(name)
        author_block[parsed_name['last_name']].append(id)
        for firstname in parsed_name['first_names']:
            author_block[firstname].append(id)
        # block_id = get_author_block(id, name, author_block)
        # if(block_id == -1):
        #     new_block = len(author_block)
        #     # author_block.update({new_block: {}})
        #     # author_block[new_block].update({id: name})
        #     author_block[new_block] = {id:name}
        # else:
        #     # author_block[block_id].update({id:name})
        #     author_block[new_block][id] = name
    for values in author_block.values():
        if(len(values) > 10):
            print(values)
    return author_block

def getAffiliation(affiliation):
    global df_affiliation
    result = ''
    formatted_affiliation = affiliation.strip()
    formatted_affiliation = ' '.join(formatted_affiliation.strip().split())
    try:
        result = df_affiliation.loc[formatted_affiliation,'result']
    except KeyError:
        getGeocode = geocoder.geocode(formatted_affiliation)
        if(len(getGeocode) == 0):
            result = formatted_affiliation
        else:
            result = getGeocode[0]['formatted']
        df_affiliation.loc[formatted_affiliation] = result
    return result

def caculate_affiliation_sim(author1, author2):
    if(not isinstance(author1['affiliation'], str) or not isinstance(author2['affiliation'], str)):
        return 0
    for author1_affiliation in str(author1['affiliation']).split(';'):
        for author2_affiliation in str(author2['affiliation']).split(';'):
            if(getAffiliation(author1_affiliation) == getAffiliation(author2_affiliation)):
                print(getAffiliation(author1_affiliation))
                return 1

def caculate_author_matching_distance(id1, id2):
    global matched_graph_node
    author1 = df_author.loc[id1]
    author2 = df_author.loc[id2]
    if(isinstance(author1['email'], str) and author1['email'] == author2['email']):
        return 1
    if(isinstance(author1['orcid'], str) and author1['orcid'] == author2['orcid']):
        return 1
    if(author1['link'].split('//')[1].split('/')[0] == author2['link'].split('//')[1].split('/')[0]):
        return 0
    if(name_matcher.match_names(simple_string(author1['name']), simple_string(author2['name'])) < 0.9):
        return 0
    affiliation_sim = caculate_affiliation_sim(author1, author2)
    if(affiliation_sim):
        return 1
    else:
        matched_graph_node.append(id1)
        matched_graph_node.append(id2)
        # print('\n suspect ',id1, id2, author1['name'], author2['name'])

    # if(not isinstance(author1['affiliation'], str) or not isinstance(author2['affiliation'], str)):
    #     print('\n==========================fuck', str(author1['affiliation']))
    #     return 0
    # for author1_affiliation in str(author1['affiliation']).split(';'):
    #     for author2_affiliation in str(author2['affiliation']).split(';'):
    #         if(author1_affiliation == author2_affiliation):
    #             return 1
    return 0

def author_match_matching(author_block):
    global matched_graph_node, file
    matched_list = defaultdict()
    for authors in author_block.values():
        if(len(authors) == 1):
            continue
        for count1, id1 in enumerate(authors):
            if(id1 in matched_list):
                id1 = matched_list[id1];
            for count2, id2 in enumerate(authors):
                if(count2 <= count1):
                    continue;
                if(id2 in matched_list):
                    id2 = matched_list[id2]
                if(id1 == id2):
                    continue;
                if(caculate_author_matching_distance(id1, id2)):
                    matched_list[id2] = id1
                    matched_list[id1] = id1
                    match_author(id1, id2)
                    continue;   
    matched_graph_node = list(set(matched_graph_node))
    for id, key in matched_list.items():
        # print('\n', id, key)
        if id in matched_graph_node:
            # print('\n', id, '->', key)
            matched_graph_node.remove(id)
            matched_graph_node.append(key)
    matched_graph_node = list(set(matched_graph_node))
    file.write(f"{matched_graph_node}\n\n=========================================\n\n")
    print(len(matched_graph_node))

def author_match_cluster():
    global matched_graph_node, file
    # distance_matrix = author_ahc_distance()
    # start = time.time()
    # end = time.time()
    # print("\n********The time of execution of none multiprocessing is :",(end-start) * 10**3, "ms******************")

    start = time.time()
    distance_matrix = multiprocessing_ahc_distance()
    end = time.time()
    print("\n********The time of execution of multiprocessing is :",(end-start) * 10**3, "ms******************")
    clustering = AgglomerativeClustering(n_clusters=None, affinity='precomputed', linkage='single', distance_threshold=0.1)
    cluster_ids = clustering.fit_predict(distance_matrix)
    print(cluster_ids)

    # Z = linkage(distance_matrix, method='average')
    # threshold = 0.8
    # print(Z)
    # cluster_ids = fcluster(Z, t = threshold, criterion='distance')
    cluster_dict = dict(zip(matched_graph_node, cluster_ids))
    # print(cluster_ids)
    # print(cluster_dict)
    cluster_node = {}
    # file.write(cluster_ids)
    print(cluster_dict)
    data_serializable = {key: int(value) for key, value in cluster_dict.items()}
    # Serialize to JSON
    json_data = json.dumps(data_serializable)
    print(json_data)
    file.write(json_data )
    for id in matched_graph_node:
        cluster_id = cluster_dict[id]
        if(cluster_id in cluster_node):
            match_author(cluster_node[cluster_id], id)
        else:
            cluster_node.update({cluster_id : id})
    print(len(cluster_node), len(cluster_dict))

def author_match_process():
    global matched_graph_node
    author_block = defaultdict(list)
    author_block = author_match_blocking(author_block)
    print('\nDone blocking')
    author_match_matching(author_block)
    # G = nx.Graph()
    # cluster_dict = {"8193": 3418, "5": 3451, "6": 18, "8199": 1879, "7": 3327, "9": 2255, "16392": 2849, "11": 2565, "8204": 2271, "16391": 1811, "16398": 2671, "20": 2879, "22": 2907, "16410": 1909, "28": 2673, "16415": 2386, "16416": 3212, "16417": 2964, "16418": 2719, "8227": 2270, "36": 2257, "38": 2281, "39": 2079, "40": 2895, "8232": 3223, "8233": 2345, "16427": 1993, "16428": 2526, "16429": 2638, "8234": 3439, "8241": 2763, "50": 2275, "8243": 2475, "52": 3343, "53": 2790, "16438": 2665, "24631": 1888, "16440": 3026, "54": 1809, "16446": 2841, "64": 2251, "65": 2249, "8261": 2274, "16455": 2551, "16456": 2539, "16469": 2197, "16471": 1828, "93": 2269, "16482": 2344, "16484": 2238, "16489": 2211, "108": 1899, "110": 1775, "8303": 3007, "8302": 2522, "16498": 1897, "115": 2043, "16500": 1887, "119": 2537, "120": 2547, "123": 3450, "127": 2371, "128": 2929, "130": 2219, "8324": 2928, "132": 3433, "8326": 2623, "133": 3434, "8325": 2264, "16523": 3425, "16525": 2401, "24721": 2193, "8338": 2215, "8339": 2118, "151": 3431, "153": 39, "16538": 1837, "155": 2341, "172": 1998, "173": 3267, "8366": 1830, "8372": 1979, "183": 2265, "187": 3419, "188": 3303, "16573": 2535, "191": 2217, "16577": 2305, "8389": 1881, "201": 3428, "16589": 3044, "16590": 3318, "8399": 3403, "8400": 2213, "8401": 1920, "8402": 2190, "8404": 2404, "213": 2259, "8406": 3000, "214": 2449, "8409": 3255, "8410": 1746, "16603": 3334, "16604": 2697, "225": 2867, "8418": 2099, "16611": 2157, "230": 3294, "231": 2513, "232": 2817, "16617": 2471, "8425": 3283, "16619": 1895, "240": 1817, "16628": 1763, "16638": 2153, "257": 2666, "16644": 2273, "261": 2835, "260": 2339, "264": 3131, "267": 2051, "269": 2205, "8462": 3046, "270": 2684, "8467": 1819, "16661": 2243, "16663": 2224, "279": 24, "281": 3363, "16665": 3010, "282": 1761, "284": 3280, "283": 2839, "16671": 2253, "16674": 3371, "16680": 1866, "296": 2015, "16682": 2299, "302": 2355, "304": 2967, "305": 2195, "306": 1946, "309": 2699, "310": 2542, "16710": 1992, "16711": 3263, "331": 2354, "334": 2439, "16719": 2081, "16721": 2467, "16723": 3051, "342": 3143, "16730": 2997, "349": 2836, "352": 2375, "353": 3387, "356": 2996, "16740": 3317, "358": 2690, "360": 3291, "363": 2027, "365": 2450, "366": 2541, "370": 2349, "8564": 2987, "374": 1967, "16763": 3333, "16764": 2229, "24955": 2747, "16766": 17, "387": 2968, "16772": 1991, "389": 2187, "16774": 2018, "391": 3300, "390": 2490, "8592": 2915, "16787": 2346, "410": 2390, "16795": 3008, "16796": 2402, "8621": 1933, "430": 2887, "431": 3038, "432": 3286, "429": 2239, "435": 23, "16820": 3287, "448": 3052, "16834": 2995, "452": 2262, "25029": 3236, "25030": 3379, "455": 2555, "8645": 2693, "454": 2963, "8648": 3295, "16845": 1945, "16851": 2979, "478": 3331, "479": 2399, "16864": 14, "16863": 13, "8675": 1867, "484": 2233, "16870": 1503, "16871": 3053, "8681": 1903, "8683": 2465, "8686": 2128, "495": 3060, "496": 2380, "8689": 3108, "497": 2300, "499": 2607, "494": 2464, "502": 2347, "25085": 1987, "16893": 2655, "25088": 1919, "8708": 2466, "16903": 3307, "16908": 3003, "531": 2953, "25109": 1957, "16920": 3261, "16921": 2340, "541": 1944, "16929": 2716, "16931": 3279, "8739": 2461, "553": 2261, "556": 3443, "16941": 2545, "16942": 2853, "16943": 2567, "561": 3452, "8756": 2951, "8759": 2981, "8760": 3275, "16954": 3050, "573": 2651, "576": 3144, "8770": 2451, "16973": 3036, "16975": 3266, "594": 2829, "596": 2859, "597": 2272, "16981": 1821, "600": 3454, "16986": 3064, "25179": 1759, "602": 2460, "8797": 2899, "25182": 2678, "25183": 2176, "16992": 2985, "606": 2010, "25186": 1999, "16994": 3273, "25189": 3015, "25190": 2223, "25193": 2338, "25194": 2657, "8810": 1953, "17004": 3268, "621": 3429, "8814": 2927, "25199": 1947, "25200": 3292, "25204": 2691, "17013": 2296, "25206": 2286, "17015": 3063, "632": 2680, "633": 2003, "25210": 2949, "25211": 3259, "17016": 2166, "25213": 3342, "25214": 3045, "17023": 2366, "17024": 2260, "17025": 2977, "639": 3107, "17027": 3378, "17026": 2827, "644": 2252, "17030": 2669, "17031": 2147, "8836": 2969, "25223": 2151, "17034": 2805, "25227": 3027, "17035": 2676, "25229": 1943, "25228": 2793, "17039": 1781, "17040": 2679, "8844": 3411, "17042": 3133, "17043": 2976, "17044": 1339, "17045": 3313, "660": 2549, "25239": 1829, "25240": 2661, "17048": 3012, "17049": 2222, "17046": 2024, "662": 2527, "25245": 2335, "665": 8, "672": 3422, "25249": 2201, "17058": 2947, "17059": 1968, "17062": 2945, "25256": 2791, "25258": 2023, "25261": 2240, "686": 2677, "25263": 3367, "25264": 2343, "25268": 3293, "692": 2019, "8886": 2139, "17079": 2073, "8887": 2787, "8889": 2540, "697": 3011, "8891": 2326, "704": 1119, "8896": 1951, "707": 1827, "709": 2307, "710": 2674, "25287": 2241, "712": 1965, "25291": 1871, "25292": 2416, "8909": 2855, "17103": 2647, "17104": 2127, "8914": 2518, "8915": 2696, "17108": 3297, "723": 1129, "726": 2779, "17111": 3055, "728": 3059, "730": 3085, "17116": 3004, "17117": 2505, "734": 2568, "25310": 2668, "735": 1845, "17118": 2283, "25312": 3151, "741": 3257, "742": 2245, "743": 2970, "25317": 2059, "17138": 3014, "17142": 2447, "25335": 2937, "17143": 2469, "8953": 2935, "17144": 2481, "17149": 2160, "17155": 3234, "772": 2177, "773": 2278, "774": 2277, "25351": 2022, "775": 2279, "17163": 3364, "25358": 2017, "25360": 2645, "8976": 3377, "25364": 2175, "17173": 2888, "791": 2675, "792": 2002, "795": 3251, "8989": 2039, "798": 3385, "17183": 2765, "25377": 2021, "8994": 2933, "8995": 1949, "17189": 2221, "17192": 2228, "25384": 2244, "17201": 3323, "25393": 2393, "17202": 2293, "17204": 2493, "25395": 1995, "17206": 2385, "822": 2459, "17215": 1997, "832": 3362, "25413": 2694, "841": 2063, "25420": 2922, "25422": 2639, "17231": 1820, "17232": 2508, "17238": 3441, "17239": 1948, "17240": 1008, "857": 95, "858": 3009, "17243": 2943, "17244": 2837, "861": 3245, "17254": 2637, "17258": 2764, "875": 1942, "17260": 1959, "17262": 2723, "17273": 3094, "17274": 2387, "17277": 1318, "895": 1332, "901": 3243, "902": 2845, "17290": 2254, "908": 1861, "17297": 3061, "914": 2120, "915": 1952, "917": 2683, "919": 1975, "25501": 2621, "25509": 2759, "25510": 2946, "25511": 2531, "9130": 995, "17324": 3344, "25517": 2287, "17330": 3340, "17332": 2966, "17333": 2009, "25525": 2681, "949": 2708, "951": 3229, "953": 2250, "25533": 3049, "17343": 1990, "17344": 1505, "962": 3253, "967": 17, "25551": 1529, "977": 2777, "17362": 3043, "17363": 3256, "980": 2936, "9170": 1463, "17366": 2670, "978": 2757, "17368": 3224, "17365": 2328, "991": 2140, "992": 3221, "17379": 2220, "996": 2441, "25576": 2322, "17386": 1862, "17389": 1816, "25583": 1011, "9203": 3054, "17403": 2321, "9212": 2149, "1021": 3056, "25601": 2267, "1026": 2421, "17417": 2008, "1036": 1914, "17421": 3254, "1038": 2994, "9229": 1891, "1039": 2495, "1041": 2633, "1048": 2682, "17432": 2941, "17436": 2035, "9244": 2191, "17438": 3299, "9245": 3013, "1054": 2792, "17440": 2276, "17445": 1843, "17446": 1872, "9254": 3083, "9256": 3376, "1065": 2862, "9257": 2491, "1063": 2783, "17448": 1869, "1066": 3258, "25646": 2851, "17456": 3262, "17459": 1996, "17460": 1941, "1077": 1790, "17462": 1900, "1078": 3219, "9272": 1907, "1076": 3068, "17469": 2883, "1092": 3217, "1094": 1336, "9287": 2919, "1096": 3065, "25670": 1525, "1098": 2931, "1099": 3215, "1100": 3132, "17481": 2563, "1102": 1745, "25678": 2971, "1103": 2000, "1105": 1134, "1106": 1825, "25683": 2025, "17494": 2433, "1110": 2672, "1114": 2230, "25690": 1136, "1116": 2289, "17500": 2707, "25697": 2948, "1127": 1923, "9320": 3006, "9323": 3375, "1137": 1666, "1138": 3421, "9345": 3332, "1154": 2753, "1155": 2361, "9348": 3399, "1156": 2216, "17549": 3455, "25744": 2643, "9362": 95, "17554": 3423, "9364": 2525, "1174": 2004, "25753": 2528, "9371": 2667, "9372": 1989, "1181": 2092, "9374": 1940, "1183": 3062, "17570": 3087, "1187": 2445, "17573": 3048, "25771": 2425, "1196": 3213, "17581": 1109, "17583": 2145, "9391": 39, "1200": 2405, "9394": 1126, "25776": 2033, "9396": 1966, "1203": 2781, "9395": 3159, "17591": 2847, "9399": 1646, "9401": 1333, "9402": 2020, "1202": 2641, "9408": 2356, "1216": 2749, "9410": 2242, "1219": 3025, "17609": 11, "17610": 1, "17611": 2, "17612": 5, "9421": 2189, "9423": 3358, "1232": 2938, "1233": 2861, "9425": 2923, "1235": 1950, "9427": 2431, "1237": 2319, "1234": 3211, "1238": 2258, "9439": 3269, "1247": 2492, "9442": 3047, "9443": 1988, "1253": 2410, "1254": 3042, "1255": 2999, "9448": 3330, "9446": 2458, "9450": 2944, "1260": 2037, "1261": 2755, "9457": 2071, "9458": 1346, "17651": 47, "1275": 3247, "1277": 2659, "1278": 1009, "1279": 2235, "9475": 1939, "9478": 3157, "9481": 3209, "9485": 1803, "9486": 2984, "17678": 2309, "9488": 3252, "9493": 3041, "9494": 3139, "17686": 40, "9499": 3250, "9500": 2026, "9502": 3207, "17707": 2463, "1328": 3447, "1329": 1506, "1331": 2453, "1332": 1128, "9525": 2119, "1334": 3205, "1335": 2456, "1336": 3203, "17721": 3432, "9530": 3374, "9529": 3201, "17726": 1901, "1343": 1776, "1344": 1826, "9534": 1335, "9536": 2218, "1346": 2745, "1348": 2700, "9541": 2652, "1349": 2930, "1355": 2369, "9547": 1815, "1357": 1913, "1361": 2664, "9553": 1120, "9555": 3005, "1363": 2337, "17750": 3420, "1367": 2748, "9560": 2761, "9558": 2921, "17753": 0, "1371": 2538, "9564": 2348, "17751": 3448, "9566": 1751, "1375": 2038, "1376": 2816, "9568": 1381, "1378": 1334, "9571": 3348, "9569": 2256, "1379": 2741, "17766": 2737, "17767": 2993, "1383": 2556, "17772": 3438, "1390": 3197, "1394": 1906, "1395": 2507, "9590": 956, "1399": 2013, "9594": 2903, "1404": 2422, "1406": 3075, "1408": 1012, "9611": 2089, "9616": 2143, "9618": 2057, "1427": 3191, "1428": 2061, "9621": 2789, "9632": 2917, "9643": 1253, "9644": 2236, "9645": 1059, "17837": 2543, "1456": 2452, "1457": 2663, "1460": 3373, "1461": 1268, "1462": 3187, "9655": 3082, "1464": 3040, "1465": 2365, "1463": 3235, "17844": 27, "9654": 3347, "1469": 1797, "1471": 2479, "26048": 1883, "9666": 3189, "9669": 1331, "1481": 3435, "1482": 3249, "9675": 3329, "9676": 1938, "17866": 3127, "9682": 2519, "9687": 972, "9690": 1908, "9692": 3446, "1500": 1777, "1502": 2916, "1503": 1749, "1504": 2005, "9697": 2644, "1507": 1224, "1508": 1138, "9702": 3386, "17898": 2803, "9709": 2606, "1518": 2858, "9710": 3440, "1517": 3188, "9713": 2780, "9719": 2376, "1527": 2247, "9721": 3058, "9722": 2860, "1538": 2263, "1539": 1130, "17924": 2785, "1546": 2834, "9741": 3039, "1549": 1210, "1552": 2735, "1554": 2379, "1555": 1981, "1557": 3185, "26133": 3076, "9749": 2911, "1563": 2721, "9759": 1787, "1570": 3366, "1571": 2534, "9764": 1937, "1572": 3365, "9766": 943, "9767": 2631, "17963": 3024, "9774": 2530, "9776": 1108, "9777": 2374, "1585": 2055, "9779": 1645, "9780": 2650, "1593": 2161, "1594": 2137, "1596": 1799, "9789": 2975, "9790": 2533, "1599": 2164, "9791": 2571, "9797": 2448, "26190": 2029, "9809": 2141, "9810": 2462, "1625": 2517, "1626": 2457, "9820": 3123, "9823": 998, "1632": 1731, "1639": 1805, "1645": 1127, "1646": 3398, "26222": 1483, "9837": 2983, "1647": 2446, "1651": 2403, "26229": 3037, "18041": 2040, "1658": 2998, "26233": 1841, "9851": 1135, "1661": 2662, "26249": 2196, "1674": 997, "1673": 2311, "9868": 1865, "18066": 2617, "9886": 1853, "18079": 3023, "1695": 3181, "1697": 1912, "1698": 2285, "1701": 1929, "1704": 2891, "9896": 2515, "1713": 2212, "1715": 3436, "1716": 3165, "1717": 2310, "1718": 1504, "9911": 1709, "1723": 3368, "1724": 1222, "9919": 2843, "1734": 2144, "1735": 3179, "1736": 3341, "1737": 1994, "9928": 2720, "9933": 2709, "9935": 1733, "9942": 2489, "9944": 2619, "26333": 752, "1758": 2955, "1759": 2857, "9952": 1782, "9949": 1925, "1764": 1468, "1765": 1783, "1773": 3177, "9966": 2112, "18157": 969, "1777": 2615, "9970": 2200, "1781": 2605, "9975": 1107, "1784": 3361, "9978": 3002, "9986": 1823, "1800": 2705, "9993": 3397, "9994": 3296, "1803": 3396, "1801": 2660, "1802": 2325, "10001": 2113, "1810": 2016, "10002": 3351, "1812": 3308, "10004": 2440, "1813": 1963, "1820": 1283, "1823": 3035, "18207": 2703, "10023": 3034, "10027": 3001, "1841": 2415, "1845": 1921, "18234": 3382, "18235": 1683, "10048": 1349, "1859": 2893, "18244": 1911, "10053": 3071, "1862": 26, "26438": 2308, "10056": 1915, "10057": 1094, "1866": 2237, "10059": 18, "26440": 2905, "18253": 1007, "18252": 914, "26448": 3175, "1873": 666, "10065": 3328, "10067": 1117, "1876": 2011, "1879": 1955, "10072": 3147, "1885": 2075, "1889": 3183, "10083": 2163, "10086": 1471, "10087": 1330, "10089": 3156, "1898": 2701, "1899": 2331, "1900": 3248, "10091": 1245, "1902": 2904, "10095": 1741, "1906": 2297, "26483": 3360, "1911": 1219, "10106": 2698, "10112": 3136, "1920": 1004, "10114": 3173, "1926": 2553, "1927": 3158, "10121": 2649, "18315": 3155, "1934": 1910, "10128": 2444, "1937": 2521, "1940": 2901, "1948": 3228, "10140": 2301, "10150": 2632, "10151": 3414, "1964": 2897, "1966": 2437, "10160": 2246, "10162": 564, "10163": 912, "1974": 2569, "10170": 2608, "10171": 1740, "10174": 2900, "10179": 1018, "10187": 3290, "1997": 3412, "1998": 2886, "1999": 2438, "2000": 2656, "10193": 2635, "10194": 3311, "2001": 2227, "18390": 3278, "2009": 1577, "2010": 1969, "2011": 3239, "2017": 2965, "2018": 2520, "2020": 2689, "2029": 2514, "10222": 3153, "2033": 1499, "10229": 2087, "2038": 1482, "2037": 2687, "10234": 2045, "2042": 2704, "10236": 2504, "2047": 1747, "2049": 1498, "2053": 3312, "10251": 2014, "10252": 1658, "10254": 3152, "2063": 1171, "2064": 2012, "10257": 2234, "2066": 2992, "2068": 974, "2069": 1464, "26650": 1229, "10276": 1935, "2085": 3372, "2086": 2896, "10280": 3442, "2090": 3359, "2093": 2468, "2099": 1964, "2100": 3149, "2102": 1121, "26682": 1005, "2107": 2685, "10300": 3306, "10302": 3370, "2115": 2597, "2116": 2159, "10309": 3444, "2119": 2320, "2120": 2083, "2123": 1936, "10315": 996, "2124": 2892, "10326": 1491, "10331": 1960, "10336": 1886, "2146": 2494, "2148": 1954, "2149": 3408, "10344": 2226, "2154": 1934, "10348": 2007, "10350": 2856, "2159": 3320, "10351": 913, "2168": 3339, "10361": 2185, "2170": 1627, "2169": 1340, "2172": 2711, "2173": 3426, "2174": 2006, "2175": 1002, "10374": 2435, "2186": 872, "10379": 1001, "2188": 2775, "2192": 968, "2199": 1931, "2200": 1785, "2204": 1793, "2207": 2284, "2208": 3315, "18595": 1917, "2214": 2077, "26793": 2135, "2218": 2932, "2217": 2381, "2220": 2427, "2219": 2298, "10423": 2350, "10427": 3161, "10428": 2409, "10429": 3022, "10430": 1860, "2238": 2192, "10435": 2648, "10437": 3033, "10440": 2162, "10441": 2199, "10443": 966, "10446": 1323, "10448": 2991, "2261": 2724, "2266": 2815, "2267": 2388, "2268": 2889, "10461": 2408, "10467": 2942, "2278": 2383, "18666": 1863, "18668": 1835, "2285": 1125, "2286": 973, "18673": 3384, "10481": 669, "2291": 2158, "18674": 1796, "18679": 2926, "18680": 1743, "10489": 2807, "10491": 3163, "2302": 3357, "18689": 1523, "10502": 3231, "10508": 1329, "2316": 3145, "10511": 2353, "10513": 2397, "2324": 3113, "2325": 3072, "2326": 1623, "2328": 2225, "2329": 1742, "10523": 2001, "2331": 3109, "10527": 2503, "2340": 993, "2344": 1800, "2347": 2924, "10540": 1932, "2352": 1231, "10545": 1663, "18737": 3057, "2355": 1905, "2356": 3383, "10546": 2512, "18739": 553, "2357": 3105, "18744": 2136, "2358": 2324, "2365": 1617, "2366": 3356, "2375": 1655, "10569": 1344, "18766": 1095, "18768": 3289, "2387": 1859, "10581": 2509, "2390": 3032, "10583": 1873, "10584": 3409, "10585": 2902, "2393": 3404, "18781": 3031, "2399": 2634, "2400": 3030, "2413": 970, "10605": 3225, "10607": 2511, "2415": 1497, "10608": 1097, "2418": 890, "2420": 2117, "2422": 3021, "2423": 3103, "2424": 2329, "2425": 3400, "10619": 2183, "2432": 1193, "2433": 3079, "2434": 3369, "10631": 3081, "2441": 3381, "10633": 1927, "2443": 2986, "10640": 19, "10642": 484, "2455": 2111, "2456": 999, "2457": 1771, "2458": 2419, "10649": 1443, "10653": 3277, "2464": 2188, "2467": 1673, "2468": 2031, "2469": 3355, "2471": 3354, "2472": 2733, "10666": 2214, "10667": 1259, "2476": 1153, "10668": 3029, "2478": 3241, "2479": 2982, "2480": 1087, "2481": 954, "2484": 1904, "10677": 2076, "10676": 971, "2485": 2360, "10681": 1495, "10684": 2658, "18877": 1106, "10686": 3028, "10685": 1154, "10688": 3407, "2509": 3069, "18897": 1986, "10708": 1316, "10711": 1739, "10713": 2881, "10714": 1255, "2524": 822, "18909": 1980, "18910": 3020, "2525": 3095, "18912": 2980, "18919": 2717, "18921": 2595, "2541": 3285, "2542": 1353, "2543": 2559, "2544": 3097, "2546": 2179, "18934": 989, "2554": 1649, "10751": 3314, "18947": 1105, "10755": 2751, "18951": 3216, "18952": 2646, "2575": 1885, "2576": 2041, "10769": 1720, "2577": 2766, "10771": 552, "18964": 2825, "2579": 9, "18966": 1890, "18967": 562, "10767": 3445, "10777": 1611, "18971": 3019, "18972": 3018, "2589": 2138, "2587": 2959, "18975": 3160, "18977": 2210, "10785": 2291, "18980": 1736, "18985": 3271, "18986": 2209, "10796": 3353, "18988": 1321, "2607": 2370, "10800": 2925, "2609": 1780, "2613": 2990, "2614": 3380, "2617": 2394, "19001": 2359, "19003": 2854, "2618": 2434, "10813": 2327, "10818": 2773, "2628": 1010, "10820": 4, "2636": 1985, "2637": 1078, "2638": 3204, "10832": 3352, "2640": 2989, "10833": 2988, "10835": 3017, "2645": 2616, "2646": 1200, "19030": 1019, "2649": 1093, "2650": 2871, "19034": 2116, "19036": 1625, "2653": 955, "10846": 2952, "19039": 965, "2655": 2561, "10851": 1324, "19045": 1163, "10854": 2097, "2666": 1322, "10861": 981, "10862": 1984, "10863": 2429, "19053": 3326, "2673": 1141, "19054": 1847, "2675": 3016, "2676": 1244, "19055": 1846, "19061": 2609, "19062": 2391, "19066": 1493, "19067": 1633, "2686": 3096, "10882": 2579, "2692": 1490, "10888": 3093, "2697": 2483, "2699": 2848, "10898": 1068, "2709": 952, "19094": 1715, "2710": 3427, "19096": 1315, "10907": 2428, "2715": 1104, "19099": 2575, "2717": 1983, "10911": 1578, "19103": 3091, "10914": 2232, "2724": 1489, "19111": 953, "2728": 3321, "10920": 3148, "19115": 3305, "2731": 1956, "19117": 1978, "19118": 3325, "2735": 2589, "2734": 1460, "2737": 2978, "2738": 1487, "19122": 2389, "10926": 1113, "10933": 1982, "10928": 2208, "10934": 2207, "2743": 2104, "2736": 2497, "10938": 3270, "10939": 2395, "19127": 2487, "10941": 1772, "19133": 546, "10943": 3281, "2751": 2121, "10945": 3338, "19136": 1961, "10948": 2302, "19141": 1122, "10949": 2873, "2760": 0, "10954": 2695, "19147": 3265, "19148": 1652, "19150": 2231, "19151": 3106, "10960": 1260, "2767": 3089, "2769": 3088, "19155": 1977, "2771": 1521, "10966": 1844, "19161": 1328, "2777": 1262, "10971": 3260, "19164": 3309, "2780": 3086, "19166": 1884, "19167": 1973, "10976": 3324, "10977": 2573, "19170": 1661, "2787": 2727, "2791": 3214, "19177": 482, "19179": 3154, "10987": 2268, "19183": 2702, "2802": 1851, "2806": 1162, "10998": 1103, "2808": 2769, "2809": 2351, "2810": 476, "19195": 2974, "19196": 1717, "11005": 2767, "2813": 2872, "2815": 3073, "19199": 1628, "19197": 869, "11009": 3417, "11012": 1712, "11015": 2282, "11016": 2363, "19207": 2295, "19210": 1930, "19211": 1626, "11020": 3322, "19224": 1114, "11033": 1976, "11034": 3171, "11036": 964, "19230": 2784, "11039": 1660, "2848": 2424, "2849": 2544, "2851": 1081, "19242": 1099, "11052": 1484, "19244": 1737, "11055": 2548, "11056": 982, "2865": 1115, "2866": 1338, "11061": 2973, "11062": 2972, "11063": 2186, "11064": 942, "19258": 2731, "19261": 929, "2878": 1327, "2881": 1485, "19267": 1258, "11085": 2206, "2894": 2364, "11088": 2156, "2897": 2920, "2900": 3084, "2901": 3077, "11096": 741, "11097": 1675, "2906": 3125, "2905": 3319, "2907": 2564, "2909": 2315, "2910": 1889, "11100": 3180, "2904": 3169, "11105": 1450, "2914": 1481, "11107": 987, "2916": 1974, "2915": 1207, "2913": 665, "2912": 1537, "2921": 3074, "2925": 1575, "2926": 3337, "11120": 2962, "19320": 2961, "2936": 1472, "19322": 2312, "19323": 1972, "2937": 979, "2943": 1194, "2945": 951, "2946": 1779, "11143": 2611, "11146": 2060, "2955": 1875, "19340": 1092, "19338": 1716, "19342": 1133, "2959": 1509, "11151": 2725, "11152": 2288, "11154": 1719, "11155": 813, "11156": 941, "19347": 2560, "2961": 1896, "19352": 2960, "19357": 3070, "2973": 1735, "11169": 935, "2983": 1836, "19368": 1971, "19370": 1502, "11179": 2712, "19375": 1102, "19377": 2524, "19381": 1970, "19382": 663, "3001": 984, "3002": 3350, "19385": 1479, "3008": 1467, "19393": 3395, "19400": 2729, "3016": 1176, "11210": 1302, "19402": 1110, "19404": 2155, "11213": 3104, "19406": 1870, "19407": 986, "3021": 1429, "3025": 2958, "3026": 2323, "19411": 2115, "19412": 1079, "3029": 2154, "3027": 3067, "19409": 990, "3032": 976, "11225": 490, "3033": 983, "11227": 1962, "3034": 980, "19421": 489, "3037": 1958, "11229": 2957, "3035": 2303, "19426": 1744, "3047": 3394, "19431": 660, "3049": 1798, "3050": 3288, "19436": 1067, "11245": 978, "19437": 1077, "11244": 2823, "11248": 3393, "19441": 934, "19442": 2629, "11250": 977, "19444": 1573, "3061": 14, "11249": 2485, "11255": 2956, "11256": 1928, "19449": 2954, "11258": 2713, "19451": 1540, "19452": 3310, "19453": 1476, "11260": 2165, "19455": 3392, "19456": 1654, "11265": 1251, "3067": 3, "3066": 1071, "11268": 1858, "3076": 1159, "11270": 1459, "3080": 1475, "19465": 963, "19467": 1756, "19469": 2732, "3087": 2642, "11279": 1632, "3088": 2516, "3091": 994, "19476": 2133, "3092": 737, "19478": 1708, "19479": 2654, "11283": 3066, "11289": 3176, "11290": 3135, "19475": 735, "19484": 1320, "3100": 2620, "3107": 1565, "3108": 1160, "3109": 1665, "19494": 2204, "3111": 2203, "3112": 3349, "3113": 2814, "19498": 3316, "3114": 2776, "11299": 2436, "3118": 975, "11310": 2869, "3122": 2692, "19508": 1270, "11316": 1507, "19513": 2715, "19515": 2950, "3132": 556, "11325": 1926, "19517": 1486, "3136": 1111, "11329": 962, "19522": 1924, "11332": 961, "3140": 1657, "19526": 1922, "3141": 1541, "19528": 1531, "3144": 3346, "3146": 3345, "3147": 1824, "19532": 960, "3142": 1461, "3145": 1474, "19535": 959, "3150": 2756, "19534": 2036, "3152": 1833, "19539": 1753, "19540": 1918, "11348": 1530, "3156": 1473, "19545": 2432, "19546": 958, "3163": 2653, "11354": 2846, "19551": 885, "11360": 2880, "19552": 1727, "19559": 1916, "3177": 1477, "19562": 3264, "3182": 2640, "19567": 470, "19568": 566, "19570": 957, "3187": 1319, "3186": 2557, "3190": 1839, "3191": 1246, "19577": 736, "19578": 1902, "3195": 950, "19579": 3402, "11387": 1462, "3196": 2599, "11391": 1760, "11389": 3227, "3198": 2032, "11394": 2423, "11395": 2636, "19587": 3336, "637": 2248, "3206": 1470, "3205": 1137, "19592": 2940, "3210": 2392, "3213": 3335, "19599": 1519, "19602": 2939, "19603": 764, "3220": 2506, "3221": 949, "640": 988, "11415": 3246, "3223": 1317, "19609": 733, "3224": 2202, "3226": 2184, "19615": 2934, "19616": 1466, "3233": 2358, "19619": 3167, "19620": 1192, "3237": 1465, "11429": 1228, "19623": 1656, "19624": 2546, "3241": 50, "3242": 1639, "19628": 3401, "645": 1091, "11442": 887, "646": 2570, "3253": 3391, "3254": 732, "19639": 474, "3255": 657, "11449": 2552, "11450": 1494, "3258": 2630, "3257": 1527, "19645": 1898, "19646": 2627, "11447": 3, "19648": 948, "11459": 731, "3268": 3410, "3269": 2420, "3270": 1642, "3271": 947, "11468": 1314, "11469": 1729, "19662": 2918, "11471": 2198, "3280": 1458, "3281": 1622, "19666": 3390, "3282": 1653, "3284": 473, "19669": 1098, "11474": 1752, "19671": 1894, "19672": 551, "19675": 3222, "3296": 1659, "19680": 3284, "19684": 1576, "19687": 479, "19688": 1893, "3305": 2771, "19690": 1457, "19691": 50, "11500": 2604, "3309": 3304, "3310": 1651, "11498": 1124, "19696": 2384, "19693": 1123, "3319": 2336, "19704": 3244, "11514": 967, "19707": 1892, "3323": 2382, "19708": 2488, "3325": 1526, "11517": 2080, "11516": 2752, "19713": 1524, "3329": 3302, "11523": 3301, "3331": 3298, "3334": 2342, "11526": 2056, "19719": 2598, "11527": 1017, "19722": 3389, "3338": 548, "3340": 2194, "3339": 1387, "3342": 1842, "11532": 3237, "3344": 1647, "19728": 1795, "19730": 560, "19731": 1096, "3351": 2833, "3353": 547, "19738": 2480, "3355": 1211, "3356": 1492, "19743": 545, "11552": 1469, "11553": 2181, "3361": 1641, "3362": 3282, "19748": 2182, "3368": 2280, "19753": 945, "11561": 944, "3371": 728, "11565": 745, "3373": 3453, "3375": 3424, "3376": 3449, "3374": 2529, "19769": 2890, "11580": 1882, "11581": 2914, "19781": 1243, "19782": 559, "3399": 1090, "3401": 2628, "11594": 992, "11597": 2053, "3406": 2067, "11599": 1667, "19790": 2180, "3407": 1273, "3410": 2414, "3412": 761, "19797": 2396, "3414": 2913, "19802": 1638, "3419": 2912, "3420": 940, "3422": 2333, "19807": 279, "11621": 1671, "3432": 3276, "3436": 1728, "3437": 1233, "19822": 2049, "3439": 1880, "3438": 2266, "3441": 3117, "19824": 1624, "11629": 2064, "3444": 2863, "19828": 2306, "11643": 2688, "11644": 2407, "11645": 1455, "11646": 1621, "19839": 939, "19840": 1313, "11648": 3119, "3458": 2587, "11651": 2028, "3455": 1197, "11653": 1769, "3457": 1542, "3465": 1878, "11658": 2173, "3466": 1778, "19854": 1257, "19855": 272, "19856": 1215, "19859": 1877, "11667": 1868, "11670": 2788, "11672": 2626, "3481": 2768, "3482": 1522, "3483": 2910, "11675": 2477, "19869": 2178, "19870": 2909, "19873": 2908, "3491": 1876, "19875": 2400, "3493": 1453, "3495": 19, "3496": 28, "19881": 475, "19884": 1271, "11692": 1784, "11694": 3388, "11695": 3138, "3504": 898, "11697": 2906, "19892": 1269, "19899": 1181, "19900": 1252, "19901": 937, "11709": 20, "11711": 1039, "3519": 469, "19905": 1452, "3522": 3142, "3521": 1451, "3525": 2624, "11718": 554, "19910": 2501, "3528": 2334, "3529": 744, "3530": 1449, "3532": 1587, "11724": 2473, "11729": 26, "3538": 1874, "3545": 1239, "3546": 2797, "11737": 456, "11740": 2772, "3549": 2536, "19933": 2804, "19934": 2618, "3551": 1637, "11742": 2174, "3553": 936, "11744": 1148, "19940": 467, "11743": 760, "3558": 1086, "3555": 1789, "3560": 1520, "3561": 759, "19944": 1166, "3563": 3274, "19947": 2317, "19951": 724, "19952": 1532, "3570": 2898, "3571": 1448, "19954": 2172, "19955": 1725, "3574": 933, "19958": 3416, "3575": 3168, "11769": 1447, "11770": 1533, "3578": 1515, "19964": 1189, "3581": 466, "19962": 1849, "3583": 1864, "19965": 1118, "3582": 1080, "3587": 931, "19971": 1636, "3589": 1688, "3590": 2760, "19977": 2069, "11787": 3242, "19979": 508, "3596": 2123, "19990": 1428, "3606": 2171, "11803": 889, "3614": 930, "3615": 723, "20000": 2600, "11812": 1857, "11823": 1267, "3632": 891, "20017": 829, "20018": 2821, "3635": 12, "11827": 2170, "11828": 3272, "20020": 2894, "3638": 464, "3639": 2442, "3640": 3080, "11833": 1232, "3641": 1539, "3642": 1635, "20026": 1446, "3649": 2591, "3651": 2710, "3653": 2603, "3656": 1343, "3657": 1765, "3658": 1856, "20047": 938, "20052": 3437, "3669": 2455, "11863": 1445, "20056": 2865, "3673": 1699, "3677": 1488, "3679": 1620, "20064": 1855, "20063": 2114, "20066": 787, "3680": 1496, "11872": 2454, "3687": 1553, "3688": 2868, "3689": 379, "11883": 1341, "11884": 3240, "3694": 722, "3696": 2472, "3697": 275, "3698": 1500, "3699": 491, "3700": 2864, "20085": 2294, "20086": 2169, "3703": 1854, "3705": 2044, "20089": 817, "11898": 1722, "3709": 1116, "3711": 1084, "3712": 3137, "11903": 1266, "20106": 926, "3724": 2743, "3726": 1852, "3727": 2625, "3728": 985, "3729": 888, "20117": 332, "3737": 1146, "11932": 2601, "11934": 925, "3753": 911, "3755": 2602, "11948": 2819, "11949": 1528, "3763": 1444, "11955": 3164, "11958": 1687, "3776": 740, "3778": 746, "3779": 1634, "11972": 1850, "3783": 2585, "3784": 2877, "3786": 2502, "11981": 742, "3790": 721, "11982": 2168, "3792": 1773, "3795": 730, "11990": 2885, "3800": 2831, "11993": 2532, "11994": 1213, "3804": 2523, "11999": 1256, "12009": 1427, "12013": 1605, "3821": 1308, "3823": 2065, "3825": 1426, "12018": 2884, "3827": 2852, "12020": 924, "12019": 1199, "12023": 629, "3833": 627, "3835": 478, "3845": 1848, "3846": 1518, "3847": 810, "12040": 922, "3849": 2167, "3850": 2593, "3851": 561, "20236": 1456, "12047": 1311, "3855": 2486, "3857": 2103, "12050": 1441, "3858": 468, "12052": 3210, "12051": 1057, "3859": 1431, "12059": 1631, "3868": 2292, "3871": 1501, "3872": 1630, "3874": 1326, "12066": 23, "3876": 1724, "3877": 462, "12073": 621, "12074": 1101, "12076": 1145, "12080": 2510, "12081": 1643, "12082": 3115, "12089": 1100, "12095": 2131, "12096": 2622, "12097": 1088, "3907": 1732, "3910": 1516, "12107": 498, "12108": 1640, "3917": 1261, "3922": 859, "3923": 2373, "12118": 483, "12119": 2799, "12122": 549, "3931": 811, "3932": 921, "3940": 1691, "3941": 1629, "12132": 3129, "3943": 1000, "3945": 1774, "3946": 1430, "12138": 812, "12140": 1310, "3949": 920, "3950": 1309, "12143": 1277, "12141": 1152, "3953": 1209, "3954": 1216, "3955": 814, "3956": 628, "3948": 2583, "3961": 2304, "3962": 743, "3963": 1182, "12156": 3140, "3964": 505, "3967": 1254, "20357": 654, "3977": 751, "3981": 2882, "3983": 2581, "3984": 1307, "3987": 533, "3989": 1440, "12183": 1606, "12186": 653, "12189": 1840, "12190": 2085, "12192": 1439, "4002": 1139, "12194": 1619, "25219": 494, "12199": 313, "12201": 1191, "4009": 1723, "12205": 280, "4014": 2686, "4016": 719, "12209": 2878, "12210": 919, "4017": 1085, "4020": 3238, "4018": 563, "12208": 734, "4023": 1337, "4026": 1508, "12218": 1838, "4027": 918, "12220": 1618, "12219": 3120, "12221": 1438, "4030": 1394, "12223": 2580, "4036": 3233, "12229": 664, "12230": 3128, "12233": 1514, "4047": 658, "12242": 2614, "12244": 3172, "4061": 932, "12257": 917, "12258": 458, "12262": 1579, "4075": 487, "12268": 2406, "12272": 1172, "4085": 1425, "12277": 1534, "4087": 3430, "4099": 2484, "4102": 2357, "4108": 2, "4109": 5, "4110": 1, "4111": 11, "12314": 3121, "20511": 727, "20514": 1454, "12334": 3232, "4144": 1513, "12355": 2876, "4163": 47, "4172": 2412, "20561": 455, "4178": 2084, "20564": 1834, "4180": 1350, "20568": 2082, "20569": 3415, "20570": 1076, "20571": 2129, "4186": 2744, "4189": 756, "20575": 1083, "4192": 27, "20579": 480, "20580": 1063, "20581": 557, "12389": 599, "20583": 2875, "20584": 916, "20585": 1535, "12394": 244, "12395": 2068, "12392": 809, "4206": 40, "20592": 712, "20593": 2125, "20596": 2152, "20597": 1831, "12405": 2739, "20605": 1604, "20609": 2584, "12418": 626, "20613": 1832, "20614": 1075, "20618": 915, "12427": 2150, "12429": 3111, "20623": 1301, "20625": 2613, "20627": 3134, "20630": 1250, "4249": 471, "20634": 1822, "12444": 910, "12445": 1074, "20638": 1693, "20639": 788, "20642": 1082, "12451": 2499, "4263": 2840, "12458": 808, "12459": 540, "12460": 909, "20653": 2148, "20650": 3141, "12464": 2332, "20659": 1695, "20660": 454, "20661": 1147, "20662": 1818, "20665": 908, "20667": 1299, "12476": 1226, "20668": 139, "4286": 20, "4291": 2378, "20676": 3146, "12485": 2290, "20680": 1073, "20681": 499, "20683": 481, "20686": 1168, "12495": 1813, "20688": 2417, "4306": 1031, "20692": 2124, "4309": 488, "20694": 536, "20700": 3124, "20701": 907, "20703": 2612, "12513": 2874, "20707": 453, "4323": 2474, "20710": 1814, "12518": 1345, "12520": 906, "12521": 625, "12522": 1442, "4332": 2318, "4333": 3199, "4334": 585, "20719": 1305, "20725": 2820, "20727": 726, "20728": 2146, "20730": 1072, "20731": 927, "4346": 1140, "20735": 1748, "12547": 1615, "12549": 2470, "20745": 725, "20746": 537, "20748": 3230, "12559": 1436, "12560": 1812, "20752": 1614, "20755": 1613, "20758": 2596, "20760": 928, "20765": 1131, "20766": 2610, "20768": 749, "12577": 2330, "12583": 1711, "12585": 1435, "20777": 497, "20780": 1568, "20783": 1304, "12592": 2122, "12591": 1512, "12593": 1757, "12596": 717, "12598": 905, "20790": 539, "20791": 281, "20797": 1648, "20798": 2870, "20801": 3226, "20803": 1581, "20805": 1303, "20806": 1242, "12620": 8, "12626": 2500, "20819": 1434, "20820": 1112, "12629": 2142, "20823": 1672, "20824": 1710, "12634": 729, "12636": 492, "4445": 1810, "20829": 1069, "20832": 1070, "12642": 1003, "12644": 534, "20837": 656, "4459": 1788, "12657": 485, "20850": 465, "20852": 904, "20853": 1612, "20865": 1616, "20866": 273, "12677": 2413, "20871": 2134, "12681": 1383, "20876": 1808, "12686": 2072, "20885": 1807, "12695": 555, "12696": 241, "12699": 573, "20893": 1066, "20895": 2132, "20898": 1433, "20899": 1806, "12708": 1563, "20901": 769, "12706": 1132, "20903": 2577, "20904": 806, "20906": 596, "12718": 2377, "12720": 1249, "20915": 667, "4532": 828, "20919": 805, "12731": 2482, "12732": 1298, "12733": 1571, "20927": 1297, "20928": 903, "20929": 1065, "20933": 716, "20936": 1361, "20937": 402, "20938": 1610, "20940": 1035, "20942": 1569, "12751": 2866, "12753": 1707, "12754": 3220, "20946": 1393, "20952": 902, "20953": 1432, "20955": 1644, "20963": 1804, "12772": 1559, "12773": 1437, "12776": 624, "4586": 757, "12780": 2130, "12781": 2426, "20979": 1609, "20980": 804, "12788": 3218, "20984": 1583, "20988": 715, "12796": 1064, "20989": 1567, "20991": 331, "12800": 357, "12801": 2091, "20994": 901, "20996": 2095, "20997": 867, "21000": 1802, "21002": 783, "21005": 1608, "12813": 2070, "12816": 1607, "12818": 2850, "12820": 366, "21014": 1424, "21016": 2107, "21024": 2362, "21025": 648, "21026": 363, "12837": 477, "12842": 863, "12843": 1149, "12844": 1791, "21037": 803, "21038": 1767, "21040": 3110, "12850": 1801, "12852": 826, "21056": 1423, "21060": 2443, "12868": 1056, "21062": 696, "12870": 2316, "21064": 711, "12873": 2594, "12871": 3193, "12875": 237, "12876": 1234, "12877": 1187, "12878": 1347, "12880": 899, "21077": 1212, "21081": 1195, "12894": 542, "12895": 2030, "21086": 853, "21094": 630, "21096": 1225, "21097": 2818, "12908": 802, "21103": 2770, "21105": 3208, "21111": 3413, "21113": 1603, "12923": 9, "21117": 1235, "21118": 1296, "21120": 753, "21123": 531, "21126": 1407, "12935": 24, "21130": 2126, "12938": 1169, "12941": 451, "12947": 897, "21140": 1422, "12950": 2706, "21143": 1062, "21151": 3206, "21159": 2740, "21160": 747, "21161": 1602, "12969": 1572, "21163": 2592, "21162": 2367, "12972": 1705, "21166": 504, "12974": 615, "21169": 1295, "12979": 2844, "21171": 2588, "21176": 1220, "12986": 2418, "21179": 1421, "12988": 565, "12989": 233, "21182": 550, "21183": 766, "21186": 2498, "21187": 2590, "21190": 1703, "21196": 1294, "13005": 2842, "21201": 448, "21202": 604, "21204": 1325, "21205": 1186, "21207": 2726, "21208": 1061, "13018": 801, "21211": 2034, "13020": 748, "13025": 1420, "21217": 1208, "21220": 1755, "13030": 1419, "21223": 1794, "13031": 1662, "21226": 2313, "4846": 714, "13040": 763, "13043": 1206, "21236": 530, "21237": 1601, "4851": 568, "21239": 1241, "21243": 1293, "21245": 2801, "13057": 709, "21255": 572, "21256": 896, "13065": 1060, "4871": 2576, "13067": 1230, "13068": 800, "13070": 1792, "4879": 2838, "21264": 3202, "21266": 1312, "13079": 1201, "13082": 2832, "4891": 529, "13084": 821, "21277": 3166, "13086": 646, "21279": 1418, "21284": 264, "21285": 2352, "21287": 1552, "13098": 1417, "4906": 328, "13100": 3092, "4913": 1173, "21298": 541, "4917": 3200, "21302": 662, "21305": 1517, "13119": 1348, "21312": 895, "13121": 894, "13120": 1227, "13130": 1223, "21322": 282, "4940": 2372, "21325": 1055, "4941": 2728, "21327": 1265, "4944": 1416, "13137": 893, "4947": 446, "21331": 393, "21333": 1786, "4949": 595, "13143": 819, "21336": 655, "21337": 444, "21338": 276, "21335": 672, "13140": 410, "13141": 1342, "4960": 1272, "4961": 277, "21347": 620, "13156": 1415, "4965": 500, "21349": 527, "21351": 2586, "13162": 1600, "21356": 892, "21359": 1599, "13167": 543, "21371": 2110, "21374": 799, "21380": 364, "21385": 1142, "13194": 3198, "13195": 1185, "13196": 1188, "21387": 1144, "21391": 1598, "21392": 2830, "5007": 718, "21394": 2109, "21395": 227, "21397": 818, "5014": 3112, "21400": 1414, "21401": 1151, "21404": 1202, "13213": 1016, "13215": 137, "13216": 1292, "21409": 1175, "5027": 820, "21413": 2828, "13221": 274, "5029": 575, "13224": 535, "21418": 1413, "21421": 823, "21425": 445, "21426": 2108, "21429": 2826, "21432": 1700, "5051": 1478, "13249": 406, "21442": 443, "21443": 1053, "13253": 1155, "21448": 1291, "13257": 1412, "21449": 1143, "21455": 3196, "21460": 221, "21465": 2368, "21466": 243, "13277": 3195, "5089": 991, "21474": 1546, "21476": 886, "13294": 1679, "21488": 442, "21489": 1770, "21491": 3194, "21494": 1566, "21495": 239, "21496": 827, "13307": 2106, "13308": 1371, "13312": 238, "21507": 3150, "21508": 362, "21509": 1480, "13315": 1300, "13316": 875, "21513": 1596, "21516": 2824, "21517": 1597, "21518": 1354, "13327": 6, "21523": 815, "21525": 1411, "13341": 870, "21533": 645, "13346": 2822, "21538": 1410, "21543": 1409, "13352": 884, "21545": 704, "13355": 2074, "21553": 1697, "13362": 1408, "5171": 613, "21559": 2105, "13372": 2478, "21564": 1051, "21566": 2102, "21572": 399, "21574": 1511, "21575": 2786, "21584": 3101, "21585": 2430, "21590": 2813, "21592": 1768, "13401": 2812, "21594": 883, "13404": 1721, "21596": 1510, "21598": 1240, "21600": 3192, "13412": 1406, "13414": 401, "21607": 2811, "13418": 1058, "21612": 2810, "13421": 900, "13422": 441, "21615": 1595, "13425": 408, "21620": 1766, "13429": 739, "21622": 882, "21630": 2809, "21632": 2808, "21640": 322, "21642": 1184, "21643": 1764, "21645": 2101, "13454": 1179, "21646": 2582, "13456": 1238, "21649": 871, "13457": 372, "13458": 713, "13460": 1664, "21653": 1196, "21655": 1290, "13464": 326, "21656": 370, "13465": 501, "21659": 2047, "21658": 1681, "13470": 1403, "21669": 118, "21670": 881, "13477": 2100, "21672": 2806, "13483": 1536, "21676": 3190, "13484": 1049, "13485": 2098, "21680": 1405, "13493": 1402, "13495": 1048, "13496": 538, "21691": 1289, "13501": 668, "21695": 634, "21697": 528, "21703": 327, "21706": 1401, "13518": 700, "21722": 1762, "21724": 880, "13532": 1594, "21725": 2802, "21730": 879, "13551": 2096, "21745": 785, "21746": 1593, "21747": 1047, "21749": 439, "13558": 435, "13557": 373, "21754": 1400, "13567": 2052, "13571": 1036, "13576": 1758, "21774": 249, "5391": 1713, "5392": 2800, "21778": 2094, "21784": 1248, "21785": 705, "21788": 1167, "21789": 2722, "13600": 878, "21792": 1183, "21794": 796, "13602": 1399, "21796": 2798, "13604": 576, "21801": 3186, "21803": 877, "13614": 2795, "13617": 381, "21811": 438, "21812": 1754, "21814": 569, "21816": 1398, "21817": 1592, "21819": 3184, "13640": 854, "21835": 765, "13643": 612, "13645": 2048, "21838": 1698, "21839": 365, "21840": 2042, "13650": 3122, "21844": 2093, "13653": 1217, "21848": 1591, "21849": 855, "21858": 457, "21866": 671, "21867": 2411, "13676": 876, "13677": 1696, "21873": 750, "13682": 611, "13681": 1218, "21875": 493, "21877": 2796, "21878": 1397, "21881": 1045, "21882": 2090, "13693": 720, "21886": 1044, "21891": 644, "21893": 2088, "13701": 1089, "21899": 437, "21902": 1221, "21905": 1043, "21906": 532, "21907": 359, "13718": 946, "21914": 3182, "13722": 795, "21916": 1178, "21920": 610, "13729": 1590, "13731": 447, "21924": 1306, "21925": 1738, "21926": 825, "13732": 1560, "21928": 608, "21936": 218, "13746": 1204, "2732": 1264, "21940": 3118, "21945": 2496, "21946": 848, "13758": 609, "21951": 868, "13771": 798, "21964": 2794, "5579": 222, "13774": 2086, "21968": 1287, "13777": 1396, "21974": 1574, "21977": 1161, "21980": 1589, "5598": 1750, "21983": 874, "2741": 450, "21987": 567, "13795": 1042, "5616": 2736, "5617": 2572, "22002": 1395, "13812": 3405, "22012": 697, "13821": 412, "13823": 1558, "22021": 1041, "22022": 673, "22025": 794, "22029": 558, "22030": 873, "13838": 452, "22032": 1050, "13844": 436, "13845": 520, "13852": 607, "13853": 3078, "13854": 220, "13866": 603, "22059": 433, "13871": 1247, "13885": 217, "13888": 2578, "13889": 1040, "13908": 1551, "13910": 754, "13918": 1392, "13919": 404, "22123": 647, "5741": 1379, "22126": 449, "22127": 382, "22129": 2476, "22130": 240, "13942": 651, "13943": 369, "13948": 1692, "13951": 1391, "5761": 707, "22146": 305, "13955": 165, "13956": 623, "13959": 1650, "5768": 371, "5772": 1180, "5774": 695, "13968": 3178, "13972": 400, "13985": 2782, "13993": 589, "22187": 519, "22191": 440, "22192": 583, "22193": 358, "5814": 708, "14007": 1588, "14009": 1390, "14015": 1164, "14016": 459, "5827": 670, "22211": 1214, "5830": 434, "14031": 1389, "14032": 361, "5847": 216, "14041": 267, "14044": 1704, "5852": 544, "22238": 614, "22239": 1279, "5860": 1288, "14055": 643, "22250": 1355, "5868": 1375, "14061": 259, "5871": 633, "5872": 1734, "5873": 847, "14067": 661, "14068": 2714, "22271": 228, "14082": 866, "14083": 312, "14084": 865, "14085": 432, "14095": 793, "14097": 226, "14098": 824, "14128": 694, "14132": 1203, "5944": 2078, "14137": 1689, "14138": 1205, "14141": 2778, "14146": 1388, "5956": 1052, "14150": 693, "14151": 1730, "14152": 346, "14155": 396, "14157": 600, "14170": 184, "14178": 3174, "14184": 605, "14185": 864, "22377": 234, "14193": 2314, "14201": 301, "14202": 1586, "22397": 807, "14206": 1263, "22403": 271, "14214": 631, "22414": 113, "22419": 2398, "22430": 710, "14242": 431, "14244": 116, "22443": 360, "14256": 1585, "14260": 263, "14261": 1352, "14262": 738, "14264": 135, "14276": 792, "14284": 215, "14285": 303, "14293": 619, "22492": 278, "22494": 579, "14318": 136, "6134": 180, "14327": 1198, "6137": 2774, "14331": 356, "6143": 309, "6144": 830, "6150": 3116, "14346": 304, "6154": 1237, "22539": 311, "14360": 758, "14368": 831, "14375": 333, "22569": 265, "22571": 1284, "10999": 376, "14386": 606, "22578": 107, "22580": 1726, "14405": 302, "14406": 179, "14407": 1386, "14420": 1150, "14425": 862, "14437": 1385, "6251": 314, "14444": 692, "22641": 405, "14451": 1682, "14454": 321, "14466": 843, "22663": 1236, "14473": 861, "6290": 163, "14484": 430, "14487": 860, "14495": 110, "6303": 3099, "14497": 1006, "14513": 3100, "14523": 138, "14525": 496, "22719": 755, "6338": 1555, "14539": 1351, "14543": 1177, "14554": 767, "14566": 323, "14568": 598, "14570": 178, "14573": 3170, "14583": 1584, "22778": 588, "6395": 160, "14593": 1685, "6402": 1384, "14595": 1038, "6405": 2574, "14598": 1286, "6407": 1158, "14600": 1037, "6409": 698, "6408": 268, "6415": 832, "6416": 703, "14609": 775, "14610": 245, "22801": 12, "6426": 518, "6428": 816, "6429": 182, "6432": 791, "14625": 602, "6435": 429, "6438": 691, "6439": 571, "6441": 395, "6442": 351, "6444": 355, "14637": 1718, "6447": 1684, "6449": 786, "6450": 1690, "6456": 570, "14649": 345, "6457": 219, "6460": 1680, "6461": 1157, "14654": 172, "14655": 858, "6464": 1382, "6465": 1190, "6466": 652, "6467": 659, "6468": 403, "6462": 851, "6471": 1582, "6472": 649, "6473": 502, "6475": 578, "6478": 1677, "6479": 414, "14673": 460, "14674": 517, "6481": 690, "14676": 354, "22868": 790, "6484": 574, "14679": 1285, "6487": 2762, "6489": 155, "14684": 367, "6493": 857, "14685": 329, "6494": 1156, "6499": 177, "6501": 428, "6502": 642, "6503": 1380, "6505": 689, "14701": 1714, "6510": 150, "6512": 407, "6514": 1359, "6515": 344, "6518": 2758, "6519": 258, "6521": 1357, "6522": 1034, "6526": 1033, "6527": 516, "14723": 1378, "6534": 2066, "6538": 622, "6539": 641, "6541": 1377, "14733": 1363, "14736": 299, "6545": 856, "14737": 1538, "14738": 140, "6549": 3162, "6550": 1032, "6551": 1545, "6552": 392, "6559": 521, "6563": 310, "14755": 601, "6565": 181, "6567": 375, "6571": 287, "22961": 202, "6578": 515, "14770": 121, "14773": 768, "14775": 185, "6583": 224, "14777": 688, "14778": 2754, "6588": 772, "6589": 151, "6590": 1021, "6592": 257, "6596": 1580, "14789": 2062, "6602": 300, "6603": 789, "22989": 394, "6607": 427, "14799": 486, "6611": 325, "14803": 1404, "14804": 675, "22998": 199, "6616": 1015, "6617": 797, "6623": 1030, "6625": 1376, "6626": 3090, "6627": 196, "6628": 374, "6630": 213, "6633": 1544, "23019": 6, "6638": 201, "6639": 426, "6641": 1706, "6643": 411, "23029": 676, "6646": 1362, "6648": 852, "6649": 131, "14844": 133, "6654": 306, "14848": 425, "6657": 212, "6658": 152, "14853": 1669, "23047": 149, "23048": 593, "6666": 618, "6667": 74, "14861": 1174, "14862": 1570, "14863": 1275, "6670": 1029, "14865": 334, "14866": 687, "6669": 507, "14868": 632, "6676": 248, "6678": 343, "14874": 186, "23067": 4, "6686": 2750, "6689": 514, "6691": 1676, "14885": 320, "6694": 330, "6695": 784, "14887": 587, "14889": 2718, "6696": 2562, "23085": 635, "6703": 2058, "6707": 1023, "6708": 1356, "6709": 1028, "23094": 525, "6711": 397, "6713": 581, "6720": 616, "6721": 699, "23106": 242, "6722": 284, "6726": 353, "6727": 3406, "14919": 503, "14920": 923, "6730": 1027, "6732": 391, "23118": 108, "14944": 1374, "14945": 1701, "23138": 782, "14947": 597, "14948": 1373, "14949": 246, "14952": 650, "23152": 686, "23162": 3130, "6780": 513, "6781": 1046, "6782": 2566, "23168": 398, "6785": 109, "6786": 120, "6791": 225, "14988": 1564, "23181": 849, "14989": 2746, "14991": 1702, "6800": 1282, "6799": 2054, "6802": 781, "14995": 577, "15005": 214, "23199": 285, "15033": 1281, "15035": 1372, "6849": 250, "15046": 162, "23241": 92, "15057": 223, "15058": 166, "6868": 685, "6873": 266, "6874": 132, "15071": 347, "15075": 701, "15078": 205, "15081": 423, "15086": 523, "6903": 463, "15098": 128, "15112": 342, "15113": 390, "15118": 495, "19289": 256, "15138": 3126, "15145": 337, "15148": 100, "15162": 2742, "15165": 1370, "15166": 1369, "15167": 1562, "6980": 839, "15174": 1054, "15175": 2050, "15179": 298, "15198": 1561, "15200": 850, "15201": 1170, "15204": 617, "3022": 592, "3023": 315, "15212": 424, "15228": 211, "15230": 297, "15234": 269, "15243": 780, "15245": 684, "7055": 762, "23461": 594, "15271": 307, "15274": 1694, "15276": 413, "7093": 846, "15285": 779, "7095": 389, "15288": 378, "15289": 845, "23482": 197, "7098": 194, "7102": 1557, "15301": 778, "15303": 2738, "7120": 286, "15314": 1026, "7124": 3114, "15322": 640, "15326": 111, "15327": 1368, "7135": 1367, "15329": 324, "15331": 1556, "15333": 777, "15336": 683, "15338": 341, "15339": 112, "15347": 1025, "15348": 296, "15351": 1668, "7168": 526, "15365": 161, "15367": 380, "15394": 512, "15396": 75, "15402": 368, "3062": 13, "15409": 236, "15410": 422, "15414": 1360, "15416": 586, "15418": 388, "15419": 88, "15420": 68, "15422": 1024, "15433": 844, "15434": 1554, "7241": 580, "23630": 2734, "23641": 283, "15455": 141, "15458": 142, "15465": 421, "15467": 90, "15472": 148, "7285": 1366, "23670": 89, "7289": 164, "15484": 292, "7293": 206, "15485": 200, "7295": 210, "15486": 415, "15488": 154, "15490": 776, "7306": 288, "15503": 591, "7313": 387, "15506": 1686, "15513": 409, "15514": 1165, "15518": 1365, "7328": 348, "15524": 1280, "15525": 511, "15534": 383, "15535": 3102, "15537": 682, "7354": 295, "7357": 639, "7360": 842, "7361": 247, "15558": 335, "15564": 289, "15565": 67, "15569": 841, "7379": 82, "7382": 461, "7388": 522, "7390": 319, "7392": 260, "7394": 99, "7397": 420, "15599": 590, "15601": 156, "7409": 190, "15623": 2730, "15625": 840, "15629": 176, "7438": 231, "7439": 193, "7445": 472, "7448": 119, "7450": 235, "15642": 159, "15644": 419, "15645": 294, "7452": 706, "15647": 79, "15648": 70, "7456": 232, "15650": 674, "15651": 308, "7458": 189, "7462": 352, "7463": 117, "15656": 204, "7465": 377, "7469": 230, "7480": 106, "7488": 584, "7490": 123, "7492": 175, "7495": 1364, "7505": 96, "23889": 679, "15702": 251, "7511": 198, "7512": 122, "15709": 2558, "23913": 293, "7530": 681, "15723": 1543, "7533": 1547, "15726": 209, "7537": 702, "7540": 350, "7541": 770, "15734": 104, "7543": 349, "15736": 1550, "15735": 146, "7546": 174, "15741": 336, "7551": 65, "7552": 188, "15744": 124, "15746": 255, "7563": 173, "15756": 1549, "15758": 774, "15759": 291, "7568": 127, "15762": 61, "15763": 262, "15764": 187, "15765": 183, "7578": 229, "15771": 1013, "15774": 105, "15778": 1678, "7587": 114, "15780": 153, "15781": 1278, "15782": 253, "15783": 771, "7602": 94, "15801": 115, "3143": 145, "15816": 44, "15817": 129, "15825": 340, "7642": 59, "15837": 838, "15844": 69, "15845": 63, "15846": 638, "15848": 3098, "15856": 316, "15857": 60, "15859": 147, "7668": 837, "7669": 143, "7670": 418, "15862": 87, "15864": 1674, "15866": 836, "7679": 270, "15876": 33, "15881": 680, "15889": 73, "15892": 835, "15903": 2554, "7712": 72, "7715": 134, "15908": 66, "15909": 1276, "15911": 2046, "15912": 93, "15916": 417, "7729": 524, "7732": 339, "7733": 52, "24116": 77, "15927": 56, "15934": 171, "7752": 169, "15966": 1358, "15974": 1022, "15977": 637, "7791": 261, "15989": 49, "15993": 318, "15995": 510, "7813": 678, "16017": 677, "16031": 2550, "16032": 1548, "16043": 170, "7856": 1274, "7857": 85, "16051": 43, "7868": 29, "16063": 98, "7872": 81, "16065": 195, "16066": 1020, "16067": 1670, "16073": 46, "16074": 157, "16086": 509, "3199": 167, "16103": 338, "16109": 773, "7921": 636, "7922": 254, "7923": 386, "7928": 385, "16121": 126, "16129": 76, "16132": 1014, "16134": 130, "7946": 32, "16142": 91, "7956": 45, "16149": 34, "16164": 834, "16166": 833, "7976": 21, "16169": 506, "16170": 55, "7979": 64, "7981": 31, "7982": 57, "7984": 208, "7986": 22, "16179": 582, "16183": 37, "16193": 416, "16196": 290, "8006": 144, "8008": 317, "16202": 252, "16204": 192, "16205": 203, "16207": 28, "8020": 97, "16212": 71, "16218": 16, "16219": 84, "16222": 35, "16224": 207, "16227": 125, "8061": 103, "16255": 58, "16263": 62, "16264": 102, "16269": 86, "16271": 36, "16280": 158, "16289": 48, "8100": 15, "16297": 384, "8113": 78, "8116": 168, "16308": 54, "16310": 83, "16327": 41, "16333": 51, "16335": 101, "19529": 25, "16339": 10, "16343": 42, "16353": 53, "19533": 191, "8175": 7, "24559": 30, "16380": 38, "16381": 80}
    # value_count = defaultdict(int)
    # # Count occurrences of each value in the dictionary
    # for value in cluster_dict.values():
    #     value_count[value] += 1
    # for index,node in df_nodes.iterrows():
    #   if node["type"] == 1:
    #     try:
    #       document = df_paper.loc[index]
    #       if(not document['doi']):
    #         print('==================fuck================\n')
    #       G.add_node(index, link = node["link"], type = node["type"],  in_match = 0, cluster = -1, size= 10, title = document["title"], doi = document["doi"])
    #     except KeyError:
    #       G.add_node(index, link = node["link"], type = node["type"],  in_match = 0, cluster = -1, size= 10)
    #     print("\ninsert node", index, "type ", node["type"])
    #   elif node["type"] == 2:
    #     in_match = 1 if index in matched_graph_node else 0
    #     cluster = -1
    #     size = 10
    #     if(str(index) in cluster_dict):
    #         if(value_count[cluster_dict[str(index)]] > 1):
    #             cluster = cluster_dict[str(index)]
    #             size = 100
    #         else:
    #             cluster = 0
    #             size = 10
    #     try:
    #       author = df_author.loc[index]
    #       G.add_node(index, link = node["link"], type = node["type"], in_match = in_match, cluster = cluster,size= size, name = author["name"], orcid = author["orcid"] if isinstance(author["orcid"], str)  else '', affiliation = author['affiliation'] if isinstance(author['affiliation'], str) else '', email = author['email'] if isinstance(author['email'], str) else '')
    #     except KeyError:
    #       G.add_node(index, link = node["link"], type = node["type"], in_match = in_match, cluster = cluster,size= size)
    #     print("\ninsert node", index, "type ", node["type"])

    # # print(grouped)
    # for id, link in df_links.iterrows():
    #   if(link['from'] in df_nodes.index and link['to'] in df_nodes.index):
    #     G.add_edge(int(link['from']),int(link['to']))

    # nx.write_gexf(G, "new_test.gexf")

    print('\nDone matching')
    print('\nAfter matching', len(df_author), len(df_links))
    author_match_cluster()
    print('\nAfter clustering', len(df_author), len(df_links))
    print('\nDone clustering')

def remove_duplicate_link():
    global df_links
    for i, link in df_links.iterrows():
        if(link['from'] > link['to']):
            df_links.loc[i]['from'] = link['to']
            df_links.loc[i]['to'] = link['from']
    df_links = df_links.drop_duplicates(subset=['from', 'to'])
# # Tính ma trận khoảng cách tùy chỉnh
# print(distance_matrix)
# Z = linkage(distance_matrix, method='ward')
# print()
# # Chọn ngưỡng và phân cụm


# print("Phân cụm các tác giả:")
# for i, author in df_author.iterrows():
#     print(f"{author['name']} - Cụm {cluster_ids[i]}")
# print(df_author.index)
# print(df_author.loc[df_author['ner_id'] == 2])
# print(caculate_neighbor_sim(df_author.iloc[4], df_author.iloc[6])),'T m. Kouzelis'
# print(name_matcher.match_names('Shaoling Sun', 'Chunling Sun'))
# match_paper()

# print(df_author)
# paper_match_process()
# author_match_process()
# print(df_matching)
# print(df_author)
api_key = "68020a7f39dd42fd9dc58971638403e6"
geocoder = OpenCageGeocode(api_key)
if __name__ == "__main__":
    manager = Manager() 
    df_author_global = manager.dict()
    df_link_global = manager.dict() 
    df_author = pd.read_csv('new_author.csv', index_col=0)
    df_author.set_index('ner_id', inplace = True)
    df_nodes = pd.read_csv('new_node.csv', index_col=0)
    df_nodes.set_index('id', inplace = True)
    df_paper = pd.read_csv('new_paper.csv', index_col=0)
    df_paper.set_index('ner_id', inplace = True)
    df_links = pd.read_csv('new_link.csv', index_col=0)
    df_affiliation = pd.read_csv('affiliation.csv')
    df_affiliation = df_affiliation.drop_duplicates(subset='affiliation')
    df_affiliation.set_index('affiliation', inplace=True)
    file = open("log.txt", "w", encoding="utf-8")
    print(df_affiliation)
    df_matching = pd.DataFrame(columns=['id1', 'id2', 'type'])
    print(df_author)
    matched_graph_node = []
    print('\nBefore match paper', len(df_author), len(df_paper))
    paper_match_process()
    print('\nAfter match paper', len(df_author), len(df_paper))
    author_match_process()
    print(df_matching)
    print(df_author)
    df_links = df_links.drop_duplicates(subset=['from', 'to'])
    df_links.to_csv('final_link.csv', index=True)
    df_paper.to_csv('final_paper.csv', index=True)
    df_author.to_csv('final_author.csv', index=True)
    df_nodes.to_csv('final_node.csv', index=True)
    df_affiliation.to_csv('affiliation.csv')
    df_matching.to_csv('matching.csv')
    file.close()
    # multiprocessing_ahc_distance()